# gold_recovery
# Описание проекта

* Компания: «Цифра»
* Отрасль: золотодобывающая


**Описание данных**
* Данные содержат **параметры добычи и очистки**
* Наименование признаков должно быть такое: **[этап].[тип_параметра].[название_параметра]** (например, **rougher.input.feed_ag**)
* Возможные значения для блока **[этап]**:
    - rougher — флотация
    - primary_cleaner — первичная очистка
    - secondary_cleaner — вторичная очистка
    - final — финальные характеристики
* Возможные значения для блока **[тип_параметра]**:
    - input — параметры сырья
    - output — параметры продукта
    - state — параметры, характеризующие текущее состояние этапа
    - calculation — расчётные характеристики


**Цель исследовани**: подготовить прототип модели машинного обучения для «Цифры». Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.


**Задачи исследования**:
* Проанализировать данные:
    - Посмотреть, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки. Сделать вывод.
    - Сравнить распределения размеров гранул сырья на обучающей и тестовой выборках (если распределения сильно отличаются друг от друга, оценка модели будет неправильной).
    - Исследуйте суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах.
    - При наличии аномальных значений в распределениях устранить их.
* Построение моделей машинного обучения:
    - Создать функцию для вычисления метрики sMAPE
    - Обучиить разные модели и оцените их качество кросс-валидацией:
        - Модель для целевого признака **`rougher.output.recovery`** по логике технологического процесса **необходимо оценивать по характеристикам, соответствующим этапу флотации**. Коэффициент восстановления золота на этапе флотации не может зависеть от последущих этапов (первичной и вторичной очисток). **Поэтому данные, характеризующие последущие этапы обработки нас не будут интересовать.**
        - Модель для целевого признака **`final.output.recovery`** по логике технологического процесса **необходимо оценивать по  характеристикам всех этапов обогащения**. **Коэффициент восстановления золота в конце технологическго процесса зависит от характеристик сырья, концентратов на всех предшедствующих этапах.**
        - Выбрать наилучшую модель.

**Основные инструменты:** `Python`, `Pandas`, `Matplotlib`, `Scikit-learn`, `NumPy`

**Направление деятельнсоти:** `Machine Learning`

# ВЫВОДЫ

* Наилучшими моделями из рассмотренных в работе оказались модели **`RandomForestRegressor`**.
* В силу долгого процесса расчета класс моделей **`RandomForestRegressor`** был ограничен:
    - глубина деревьев ограничивалась глубиной деревьев из 5 лучших моделей типа **`DecisionTreeRegressor`**
    - количество деревьев было ограничено 2 значаниями: 25 и 50.


* Для прогнозирования целевого признака **`rougher.output.recovery`** наилучшей с точки зрения метрики **sMAPE** оказалась модель:
    - Тип модели: **`RandomForestRegressor`**
    - Глубина деревьев: **20**
    - Колтчество деревьев: **50**
* Для прогнозирования целевого признака **`rougher.output.recovery`** наилучшей с точки зрения  метрики **средней sMAPE с кросс-валидацией** оказалась модель:
    - Тип модели: **`RandomForestRegressor`**
    - Глубина деревьев: **22**
    - Колтчество деревьев: **50**


* Для прогнозирования целевого признака **`final.output.recovery`** наилучшей с точки зрения метрики **sMAPE** оказалась модель:
    - Тип модели: **`RandomForestRegressor`**
    - Глубина деревьев: **20**
    - Колтчество деревьев: **50**
* Для прогнозирования целевого признака **`final.output.recovery`** наилучшей с точки зрения метрики **средней sMAPE с кросс-валидацией** оказалась модель:
    - Тип модели: **`RandomForestRegressor`**
    - Глубина деревьев: **22**
    - Колтчество деревьев: **50**
    
* При использовании этих наилучших моделей **итоговое значение метрики sMAPE** составило **0.5164 %**
* При использовании этих наилучших моделей **итоговое значение метрики sMAPE с кросвалидацией** составило **1.0527 %**


* Обученные модели показали относительно неплохое качество прогноза со средней симметричной процентной ошибкой  0.52%-1.05%.
